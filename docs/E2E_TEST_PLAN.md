# WebView 앱 E2E 시나리오 테스트 플랜 (Manual / Automation-ready)

## 목적
- WebView 앱의 핵심 사용자 흐름(로그인 → 방 목록 → 방 입장(WS) → 업로드 → 실시간 수신)이 **수동 테스트로 재현 가능**하고, 추후 **자동화(Playwright/Cypress 등)로 옮기기 쉬운 형태**의 체크리스트를 제공한다.

## 사전 조건 (Preconditions)
- 앱 빌드/실행 가능 상태 (로컬 또는 스테이징)
- API Base URL 설정:
  - `.env`의 `VITE_API_BASE_URL` 사용 (예: `http://localhost:8080`)
- 테스트 계정 2개 준비 (권장: 송신자/수신자 역할 분리)
  - `userA`(송신자), `userB`(수신자)
  - 각 계정의 로그인 수단(아이디/비밀번호 or 토큰)과 권한/가입 상태가 유효해야 함
- 테스트용 방 1개 준비 (방 ID/이름 기록)
  - (가능하면) `userA`, `userB` 모두 참여 가능한 상태
- 네트워크/로그 캡처 준비:
  - WebView 디버그 로그(콘솔), 네트워크 탭(HAR 가능하면), WS 프레임 로그
  - 실패 시 스크린샷(또는 화면 녹화) + 타임스탬프 + 재현 절차

## 증적(Evidence) 수집 기준
- 케이스당 최소 1개:
  - 성공: 최종 화면(실시간 수신이 보이는 상태) 스크린샷
  - 실패: 에러 메시지/상태 코드/재시도 동작이 보이는 스크린샷 + 콘솔/네트워크 로그
- 공통:
  - 테스트 일시, 환경(API Base URL), 계정, 방 정보(이름/ID), 앱 버전(커밋/태그) 기록

## 테스트 케이스 체크리스트

### HP-01: Happy Path (로그인 → 방 목록 → 방 입장(WS) → 업로드 → 실시간 수신)
- 준비:
  - 기기/에뮬레이터 2대 또는 브라우저 2개 세션 준비 (`userA`, `userB`)
- Steps (A=송신자 / B=수신자):
  1. (A) 앱 실행 후 로그인 성공 (`userA`)
  2. (A) 방 목록 화면 진입, 목록 로딩 성공(로딩/빈상태 처리 포함)
  3. (A) 특정 방 선택 후 방 입장 성공
     - 기대: WS 연결(또는 실시간 연결) 성립, 연결 실패 메시지 없음
  4. (B) 별도 세션에서 로그인 성공 (`userB`) 후 동일 방 입장 성공
     - 기대: WS 연결 성립
  5. (A) 업로드 실행 (이미지/파일/메시지 중 실제 기능 기준)
     - 기대: 업로드 요청 성공(2xx), UI상 업로드 완료 표시
  6. (B) 실시간 수신 확인
     - 기대: 업로드된 콘텐츠/메시지가 **지연 없이**(허용 지연 정의: 팀 기준, 예: 3초 이내) 화면에 표시
  7. (A/B) 방 나가기 또는 앱 백그라운드/복귀 후 상태 정상
- Capture:
  - (A) 업로드 요청/응답 로그(상태 코드 포함)
  - (B) 실시간 수신 화면 스크린샷

### FC-01: 업로드 실패 처리 (서버 오류/네트워크 오류)
- 목적: 업로드 실패 시 사용자에게 명확한 피드백과 재시도 경로가 있는지 확인
- 방법(택1):
  - 서버에서 의도적으로 5xx 반환하도록 구성
  - 로컬에서 네트워크 차단/오프라인 전환 후 업로드
- Steps:
  1. 정상 로그인/방 입장 후 업로드 수행
  2. 업로드 실패 유도
- 기대:
  - 오류 메시지가 사용자에게 노출(토스트/다이얼로그/인라인 등)
  - 앱이 크래시/무한 로딩 상태에 빠지지 않음
  - 재시도 가능(버튼/재시도 안내/다시 시도 시 정상 동작)
- Capture:
  - 실패 화면 스크린샷
  - 네트워크 로그(요청/응답 또는 실패 원인)

### FC-02: 401(인증 만료/미인증) 처리
- 목적: 인증 실패 시 로그인 복귀/토큰 갱신/에러 핸들링이 일관적인지 확인
- 준비: 만료 토큰/미인증 상태를 재현할 수 있어야 함(예: 로그아웃 후 보호 API 호출)
- Steps(예시):
  1. 로그인 후 토큰 만료/삭제를 유도 (환경에 맞게 수행)
  2. 방 목록 로딩 또는 업로드 등 보호 API를 호출하는 동작 수행
- 기대:
  - 401 발생 시 사용자에게 안내가 표시됨
  - 로그인 화면으로 유도되거나(또는 자동 재인증) 이후 동작이 명확히 차단됨
  - 비정상 상태(무한 스피너, 빈 화면, 반복 팝업)가 발생하지 않음
- Capture:
  - 401 응답(상태 코드) 확인 가능한 네트워크 로그
  - 전환된 화면(로그인/에러) 스크린샷

### FC-03: WS 끊김/재연결 처리
- 목적: 실시간 연결이 끊겼을 때 사용자 경험과 복구 동작을 확인
- 방법(택1):
  - 서버 WS 종료
  - 네트워크 잠시 끊기(비행기모드/프록시 차단) 후 복구
- Steps:
  1. 정상 방 입장 후 실시간 연결이 된 상태 확인
  2. WS 끊김 유도
  3. 네트워크 복구 또는 앱 포그라운드 복귀 등으로 재연결 유도
- 기대:
  - 끊김 상태를 감지하고 사용자에게 안내(또는 조용한 재시도)가 동작
  - 재연결 성공 시 실시간 수신이 다시 동작
  - 끊김 상태에서 업로드 시도 시 명확한 실패 처리 또는 큐잉 정책이 일관적
- Capture:
  - WS 프레임/연결 상태 로그(가능하면)
  - 끊김/복구 시점 스크린샷

## 자동화 전환 가이드 (간단)
- 우선 자동화 후보:
  - HP-01 전체(단일 기기/단일 세션) + FC-02(401) + FC-03(재연결)
- 자동화 시 필요한 것:
  - 안정적인 테스트 계정/테스트 데이터 초기화(방 생성/참여)
  - 네트워크/WS를 제어할 수 있는 테스트 훅(스테이징 토글 또는 프록시)
  - 화면 주요 요소에 대한 안정적인 식별자(`data-testid` 등)

## 완료 기준 (Issue #35)
- 본 문서가 리포지토리에 추가되어 있고, README에서 링크로 접근 가능하다.
- 아래 케이스가 **체크리스트 형태로** 정의되어 있다:
  - Happy Path: 로그인 → 방 목록 → 방 입장(WS) → 업로드 → 실시간 수신
  - Failure: 업로드 실패 / 401 / WS 끊김
- 각 케이스에 대해:
  - 사전 조건(환경/계정/API Base URL)과
  - 기대 결과(패스/페일 판단 기준)와
  - 증적 수집 항목(스크린샷/로그)이 명시되어 있다.

